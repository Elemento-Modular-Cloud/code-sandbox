<html>
    <head>
        <title>CSS Atmosphere 2 - Simplified Controls</title>
        <link rel="stylesheet" href="atmosphere.css">
        <style>
            .control-panel {
                position: fixed;
                top: 20px;
                left: 20px;
                background: rgba(0, 0, 0, 0.9);
                padding: 20px;
                border-radius: 10px;
                color: white;
                font-family: Arial, sans-serif;
                z-index: 1000;
                max-height: 90vh;
                overflow-y: auto;
                width: 300px;
                border: 1px solid #333;
            }
            
            .control-panel h3 {
                margin: 0 0 15px 0;
                color: #87CEEB;
                border-bottom: 1px solid #333;
                padding-bottom: 5px;
            }
            
            .control-group {
                margin-bottom: 20px;
                padding: 10px;
                background: rgba(255, 255, 255, 0.05);
                border-radius: 5px;
            }
            
            .control-group h4 {
                margin: 0 0 10px 0;
                color: #4682B4;
                font-size: 14px;
            }
            
            .slider-container {
                margin-bottom: 10px;
            }
            
            .slider-container label {
                display: block;
                margin-bottom: 5px;
                font-size: 12px;
                color: #ccc;
            }
            
            .slider-container input[type="range"] {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .slider-container input[type="color"] {
                width: 50px;
                height: 30px;
                border: none;
                border-radius: 3px;
                cursor: pointer;
            }
            
            .value-display {
                font-size: 11px;
                color: #888;
                margin-left: 10px;
            }
            
            .dropdown-container {
                margin-bottom: 10px;
            }
            
            .dropdown-container label {
                display: block;
                margin-bottom: 5px;
                font-size: 12px;
                color: #ccc;
            }
            
            .dropdown-container select {
                width: 100%;
                padding: 8px;
                background: #333;
                color: white;
                border: 1px solid #555;
                border-radius: 3px;
                font-size: 12px;
            }
            
            .reset-button {
                width: 100%;
                padding: 10px;
                background: #8B0000;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                margin-top: 10px;
            }
            
            .reset-button:hover {
                background: #A52A2A;
            }
        </style>
    </head>
    <body>
        <div class="control-panel">
            <h3>Planet Controls</h3>
            
            <!-- Planet Texture Selection -->
            <div class="control-group">
                <h4>Planet Texture</h4>
                <div class="dropdown-container">
                    <label>Select Planet:</label>
                    <select id="planetTexture" onchange="changePlanetTexture()">
                        <option value="earth">Earth</option>
                        <option value="mars">Mars</option>
                        <option value="venus">Venus</option>
                        <option value="jupiter">Jupiter</option>
                    </select>
                </div>
            </div>
            
            <!-- Size Controls -->
            <div class="control-group">
                <h4>Size</h4>
                <div class="slider-container">
                    <label>Planet Size: <span class="value-display" id="planetSizeValue">30vw</span></label>
                    <input type="range" id="planetSize" min="10" max="50" value="30" step="1">
                </div>
                <div class="slider-container">
                    <label>Atmosphere Size: <span class="value-display" id="atmosphereDeltaValue">10px</span></label>
                    <input type="range" id="atmosphereDelta" min="5" max="30" value="10" step="1">
                </div>
            </div>
            
            <!-- Planet Controls -->
            <div class="control-group">
                <h4>Planet</h4>
                <div class="slider-container">
                    <label>Planet Hue:</label>
                    <input type="color" id="planetHue" value="#87CEEB">
                </div>
                <div class="slider-container">
                    <label>Planet Opacity: <span class="value-display" id="planetOpacityValue">100%</span></label>
                    <input type="range" id="planetOpacity" min="0" max="100" value="100" step="5">
                </div>
                <div class="dropdown-container">
                    <label>Texture Blend Mode:</label>
                    <select id="textureBlendMode" onchange="updateTextureBlendMode()">
                        <option value="normal">Normal</option>
                        <option value="multiply">Multiply</option>
                        <option value="screen">Screen</option>
                        <option value="overlay">Overlay</option>
                        <option value="soft-light">Soft Light</option>
                        <option value="hard-light">Hard Light</option>
                        <option value="color-dodge">Color Dodge</option>
                        <option value="color-burn">Color Burn</option>
                        <option value="darken">Darken</option>
                        <option value="lighten">Lighten</option>
                        <option value="difference">Difference</option>
                        <option value="exclusion">Exclusion</option>
                        <option value="hue">Hue</option>
                        <option value="saturation">Saturation</option>
                        <option value="color">Color</option>
                        <option value="luminosity">Luminosity</option>
                    </select>
                </div>
            </div>
            
            <!-- Atmosphere Controls -->
            <div class="control-group">
                <h4>Atmosphere</h4>
                <div class="slider-container">
                    <label>
                        <input type="checkbox" id="atmosphereToggle" checked> Show Atmosphere
                    </label>
                </div>
                <div class="slider-container">
                    <label>Atmosphere Hue:</label>
                    <input type="color" id="atmosphereHue" value="#6495ED">
                </div>
                <div class="slider-container">
                    <label>Atmosphere Opacity: <span class="value-display" id="atmosphereOpacityValue">15%</span></label>
                    <input type="range" id="atmosphereOpacity" min="0" max="100" value="15" step="5">
                </div>
            </div>
            
            <button class="reset-button" onclick="resetToDefaults()">Reset to Defaults</button>
        </div>
        
        <div class="planet-container" id="planetContainer">
            <div class="planet-shadow"></div>
            <div class="planet"></div>
            <div class="atmosphere"></div>
        </div>
        
        <script>
            // Planet texture configurations
            const planetTextures = {
                earth: {
                    texture: './earth.png',
                    defaultHue: '#87CEEB',
                    atmosphereHue: '#6495ED',
                    defaultOpacity: 8,
                    defaultAtmosphereSize: 10
                },
                mars: {
                    texture: './mars.png',
                    defaultHue: '#FFD9A8', // Changed from #CD5C5C to orange
                    atmosphereHue: '#FF8C00', // Changed from #FF4500 to orange
                    defaultOpacity: 6,
                    defaultAtmosphereSize: 0
                },
                venus: {
                    texture: './venus.png',
                    defaultHue: '#F4A460',
                    atmosphereHue: '#FFD700',
                    defaultOpacity: 12,
                    defaultAtmosphereSize: 15
                },
                jupiter: {
                    texture: './jupiter.png',
                    defaultHue: '#DEB887',
                    atmosphereHue: '#FFD700',
                    defaultOpacity: 10,
                    defaultAtmosphereSize: 20
                }
            };
            
            // Initialize controls
            function initializeControls() {
                // Size controls
                document.getElementById('planetSize').addEventListener('input', updatePlanetSize);
                document.getElementById('atmosphereDelta').addEventListener('input', updateAtmosphereDelta);
                
                // Planet controls
                document.getElementById('planetHue').addEventListener('input', updatePlanetHue);
                document.getElementById('planetOpacity').addEventListener('input', updatePlanetOpacity);
                document.getElementById('textureBlendMode').addEventListener('change', updateTextureBlendMode);
                
                // Atmosphere controls
                document.getElementById('atmosphereToggle').addEventListener('change', toggleAtmosphere);
                document.getElementById('atmosphereHue').addEventListener('input', updateAtmosphereHue);
                document.getElementById('atmosphereOpacity').addEventListener('input', updateAtmosphereOpacity);
            }
            
            function updatePlanetSize() {
                const size = document.getElementById('planetSize').value;
                document.getElementById('planetSizeValue').textContent = size + 'vw';
                document.documentElement.style.setProperty('--planet-size', size + 'vw');
                updateAtmosphereSize();
            }
            
            function updateAtmosphereDelta() {
                const delta = document.getElementById('atmosphereDelta').value;
                document.getElementById('atmosphereDeltaValue').textContent = delta + 'px';
                document.documentElement.style.setProperty('--atmosphere-delta', delta + 'px');
                updateAtmosphereSize();
            }
            
            function updateAtmosphereSize() {
                const size = document.getElementById('planetSize').value;
                const delta = document.getElementById('atmosphereDelta').value;
                document.documentElement.style.setProperty('--atmosphere-size', `calc(${size}vw + ${delta}px)`);
            }
            
            function updatePlanetHue() {
                const hue = document.getElementById('planetHue').value;
                // Update planet colors based on the selected hue
                const colors = generateColorPalette(hue);
                document.documentElement.style.setProperty('--planet-primary', colors.primary);
                document.documentElement.style.setProperty('--planet-secondary', colors.secondary);
                document.documentElement.style.setProperty('--planet-tertiary', colors.tertiary);
                document.documentElement.style.setProperty('--planet-dark', colors.dark);
                document.documentElement.style.setProperty('--planet-deep', colors.deep);
                
                // Update lighting effects to match planet hue
                updateLightingEffects(hue, 'planet');
            }
            
            function updatePlanetOpacity() {
                const opacity = document.getElementById('planetOpacity').value;
                document.getElementById('planetOpacityValue').textContent = opacity + '%';
                document.documentElement.style.setProperty('--texture-opacity', opacity / 100);
            }
            
            function updateTextureBlendMode() {
                const blendMode = document.getElementById('textureBlendMode').value;
                document.documentElement.style.setProperty('--texture-blend-mode', blendMode);
            }
            
            function updateAtmosphereHue() {
                const hue = document.getElementById('atmosphereHue').value;
                const opacity = document.getElementById('atmosphereOpacity').value / 100;
                
                // Convert hex to rgba for atmosphere colors
                const rgba = hexToRgba(hue, opacity);
                document.documentElement.style.setProperty('--atmosphere-outer', rgba);
                document.documentElement.style.setProperty('--atmosphere-mid', rgba);
                document.documentElement.style.setProperty('--atmosphere-inner', rgba);
                document.documentElement.style.setProperty('--atmosphere-horizon', rgba);
                document.documentElement.style.setProperty('--atmosphere-highlight', rgba);
                
                // Update lighting effects to match atmosphere hue
                updateLightingEffects(hue, 'atmosphere');
            }
            
            function updateAtmosphereOpacity() {
                const opacity = document.getElementById('atmosphereOpacity').value;
                document.getElementById('atmosphereOpacityValue').textContent = opacity + '%';
                updateAtmosphereHue(); // Recalculate with new opacity
            }
            
            function toggleAtmosphere() {
                const isVisible = document.getElementById('atmosphereToggle').checked;
                const atmosphere = document.querySelector('.atmosphere');
                
                if (isVisible) {
                    atmosphere.style.display = 'block';
                    updateAtmosphereHue(); // Restore atmosphere appearance
                } else {
                    atmosphere.style.display = 'none';
                }
            }
            
            function changePlanetTexture() {
                const selectedPlanet = document.getElementById('planetTexture').value;
                const config = planetTextures[selectedPlanet];
                
                if (config) {
                    // Update texture
                    document.documentElement.style.setProperty('--planet-texture', `url('${config.texture}')`);
                    
                    // Update default colors, opacity, and atmosphere size
                    document.getElementById('planetHue').value = config.defaultHue;
                    document.getElementById('atmosphereHue').value = config.atmosphereHue;
                    document.getElementById('atmosphereOpacity').value = config.defaultOpacity;
                    document.getElementById('atmosphereDelta').value = config.defaultAtmosphereSize;
                    
                    // Update the planet and atmosphere
                    updatePlanetHue();
                    updateAtmosphereHue();
                    updateAtmosphereOpacity();
                    updateAtmosphereDelta();
                }
            }
            
            function generateColorPalette(baseHue) {
                // Simple color palette generation based on base hue
                const colors = {
                    primary: baseHue,
                    secondary: adjustBrightness(baseHue, -20),
                    tertiary: adjustBrightness(baseHue, -40),
                    dark: adjustBrightness(baseHue, -60),
                    deep: adjustBrightness(baseHue, -80)
                };
                return colors;
            }
            
            function adjustBrightness(hex, percent) {
                const num = parseInt(hex.replace("#", ""), 16);
                const amt = Math.round(2.55 * percent);
                const R = (num >> 16) + amt;
                const G = (num >> 8 & 0x00FF) + amt;
                const B = (num & 0x0000FF) + amt;
                return "#" + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                    (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                    (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
            }
            
            function hexToRgba(hex, alpha) {
                const r = parseInt(hex.slice(1, 3), 16);
                const g = parseInt(hex.slice(3, 5), 16);
                const b = parseInt(hex.slice(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${alpha})`;
            }
            
            function updateLightingEffects(hue, source) {
                const planetHue = document.getElementById('planetHue').value;
                const atmosphereHue = document.getElementById('atmosphereHue').value;
                
                // Determine which hue to use for lighting effects
                let lightingHue = source === 'planet' ? planetHue : atmosphereHue;
                
                // Generate lighting colors based on the selected hue
                const lightingColors = generateLightingPalette(lightingHue);
                
                // Update shadow, highlight, and glow colors
                document.documentElement.style.setProperty('--shadow-color', lightingColors.shadow);
                document.documentElement.style.setProperty('--highlight-color', lightingColors.highlight);
                document.documentElement.style.setProperty('--glow-color', lightingColors.glow);
                
                // Update cloud and surface colors to complement the lighting
                document.documentElement.style.setProperty('--cloud-light', lightingColors.cloudLight);
                document.documentElement.style.setProperty('--cloud-medium', lightingColors.cloudMedium);
                document.documentElement.style.setProperty('--surface-band', lightingColors.surfaceBand);
            }
            
            function generateLightingPalette(hue) {
                // Convert hex to RGB for calculations
                const rgb = hexToRgb(hue);
                
                // Create shadow (darker version of the hue)
                const shadowRgb = darkenColor(rgb, 0.7);
                const shadow = `rgba(${shadowRgb.r}, ${shadowRgb.g}, ${shadowRgb.b}, 0.4)`;
                
                // Create highlight (lighter version of the hue)
                const highlightRgb = lightenColor(rgb, 0.3);
                const highlight = `rgba(${highlightRgb.r}, ${highlightRgb.g}, ${highlightRgb.b}, 0.2)`;
                
                // Create glow (bright version with high opacity)
                const glowRgb = lightenColor(rgb, 0.5);
                const glow = `rgba(${glowRgb.r}, ${glowRgb.g}, ${glowRgb.b}, 0.929)`;
                
                // Create cloud colors (white with slight tint)
                const cloudLight = `rgba(255, 255, 255, 0.1)`;
                const cloudMedium = `rgba(${Math.min(255, rgb.r + 50)}, ${Math.min(255, rgb.g + 50)}, ${Math.min(255, rgb.b + 50)}, 0.15)`;
                
                // Create surface band (darker version)
                const surfaceRgb = darkenColor(rgb, 0.8);
                const surfaceBand = `rgba(${surfaceRgb.r}, ${surfaceRgb.g}, ${surfaceRgb.b}, 0.3)`;
                
                return {
                    shadow,
                    highlight,
                    glow,
                    cloudLight,
                    cloudMedium,
                    surfaceBand
                };
            }
            
            function hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : {r: 0, g: 0, b: 0};
            }
            
            function darkenColor(rgb, factor) {
                return {
                    r: Math.round(rgb.r * factor),
                    g: Math.round(rgb.g * factor),
                    b: Math.round(rgb.b * factor)
                };
            }
            
            function lightenColor(rgb, factor) {
                return {
                    r: Math.min(255, Math.round(rgb.r + (255 - rgb.r) * factor)),
                    g: Math.min(255, Math.round(rgb.g + (255 - rgb.g) * factor)),
                    b: Math.min(255, Math.round(rgb.b + (255 - rgb.b) * factor))
                };
            }
            
            function resetToDefaults() {
                // Reset to Earth defaults
                document.getElementById('planetTexture').value = 'earth';
                document.getElementById('planetSize').value = 30;
                document.getElementById('atmosphereDelta').value = 10;
                document.getElementById('planetHue').value = '#87CEEB';
                document.getElementById('planetOpacity').value = 100;
                document.getElementById('textureBlendMode').value = 'normal';
                document.getElementById('atmosphereHue').value = '#6495ED';
                document.getElementById('atmosphereOpacity').value = 8; // Reduced from 15
                document.getElementById('atmosphereToggle').checked = true;
                
                // Update all values
                updatePlanetSize();
                updateAtmosphereDelta();
                updatePlanetHue();
                updatePlanetOpacity();
                updateTextureBlendMode();
                updateAtmosphereHue();
                updateAtmosphereOpacity();
                toggleAtmosphere();
                changePlanetTexture();
            }
            
            // Initialize when page loads
            window.addEventListener('load', () => {
                initializeControls();
                resetToDefaults();
            });
        </script>
    </body>
</html>